<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test Semana</title>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-slate-100 p-8">
    <div class="max-w-4xl mx-auto">
        <h1 class="text-3xl font-bold mb-6">Test Calculador de Semanas</h1>
        
        <div class="bg-white rounded-lg p-6 mb-6">
            <h2 class="text-xl font-bold mb-4">Prueba con actividades precargadas</h2>
            <div class="space-y-4">
                <div>
                    <a href="semana.html?y=2025&m=1&d=1" target="_blank" 
                       class="block p-4 bg-blue-100 rounded-lg hover:bg-blue-200 transition">
                        <strong>Test 1:</strong> Sin actividades<br>
                        <code class="text-xs">semana.html?y=2025&m=1&d=1</code>
                    </a>
                </div>
                
                <div>
                    <button onclick="testWithActivities()" 
                            class="w-full p-4 bg-green-100 rounded-lg hover:bg-green-200 transition text-left">
                        <strong>Test 2:</strong> Con actividades (generadas dinámicamente)<br>
                        <code class="text-xs">Clic para generar URL con actividades</code>
                    </button>
                </div>

                <div id="generatedURL" class="hidden">
                    <label class="block font-bold mb-2">URL Generada:</label>
                    <textarea readonly rows="4" id="urlDisplay" class="w-full p-3 bg-gray-100 rounded text-xs font-mono"></textarea>
                    <button onclick="copyURL()" class="mt-2 px-4 py-2 bg-blue-600 text-white rounded">
                        Copiar URL
                    </button>
                </div>
            </div>
        </div>

        <div class="bg-white rounded-lg p-6">
            <h2 class="text-xl font-bold mb-4">Vista Previa</h2>
            <iframe id="preview" src="semana.html?y=2025&m=1&d=1" class="w-full h-96 border rounded"></iframe>
        </div>
    </div>

    <script>
        function testWithActivities() {
            const activities = {
                "1": ["Entrega de documentos", "Análisis de sistema"],
                "2": ["Evaluación 30%", "Análisis de sistema"],
                "3": ["Desarrollo de prototipos", "Reunión de equipo"],
                "4": ["Presentación final", "Entrega de proyecto"]
            };
            
            const activitiesJSON = encodeURIComponent(JSON.stringify(activities));
            const url = `semana.html?y=2025&m=1&d=1&activities=${activitiesJSON}`;
            
            document.getElementById('urlDisplay').value = url;
            document.getElementById('generatedURL').classList.remove('hidden');
            
            // Update preview
            document.getElementById('preview').src = url;
            
            console.log('JSON Original:', activities);
            console.log('JSON Stringified:', JSON.stringify(activities));
            console.log('JSON Encoded:', activitiesJSON);
            console.log('URL Final:', url);
        }

        function copyURL() {
            const textarea = document.getElementById('urlDisplay');
            textarea.select();
            document.execCommand('copy');
            alert('URL copiada al portapapeles');
        }
    </script>
</body>
</html>
